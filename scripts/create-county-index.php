<?php

// Config
require __DIR__ . '/../vendor/autoload.php';
$db = require __DIR__ . '/../app/config/database.php';

$elasticaClient = new \Elastica\Client();

$elasticaIndex = $elasticaClient->getIndex('counties');

// Drop and recreate the index (is there a better way to do this? Should we just drop the county type?)
if ($elasticaIndex->exists()) $elasticaIndex->delete();
$elasticaIndex->create();

// Define the mapping
$elasticaType = $elasticaIndex->getType('county');

// Define mapping
$mapping = new \Elastica\Type\Mapping();
$mapping->setType($elasticaType);

$mapping->setProperties(array(
    'id'      => array('type' => 'integer'),
    'name'     => array('type' => 'string', 'include_in_all' => TRUE),
    'shape'     => array('type' => 'geo_shape', 'include_in_all' => TRUE)
));

$counties = array(
	'Addison' => array(
		array("lat"=> 44.2627, "lon"=> -73.2288),
		array("lat"=> 44.2955, "lon"=> -72.9714),
		array("lat"=> 44.1641, "lon"=> -72.9549),
		array("lat"=> 44.0710, "lon"=> -72.9166),
		array("lat"=> 44.0272, "lon"=> -72.7413),
		array("lat"=> 43.9615, "lon"=> -72.7906),
		array("lat"=> 43.8629, "lon"=> -72.8673),
		array("lat"=> 43.9012, "lon"=> -72.8783),
		array("lat"=> 43.8683, "lon"=> -72.9714),
		array("lat"=> 43.8245, "lon"=> -72.9604),
		array("lat"=> 43.8026, "lon"=> -73.0152),
		array("lat"=> 43.8464, "lon"=> -73.0316),
		array("lat"=> 43.8355, "lon"=> -73.2178),
		array("lat"=> 43.7643, "lon"=> -73.2069),
		array("lat"=> 43.7533, "lon"=> -73.3657),
		array("lat"=> 43.8081, "lon"=> -73.3767),
		array("lat"=> 44.0162, "lon"=> -73.4041),
		array("lat"=> 44.0436, "lon"=> -73.4369),
		array("lat"=> 44.1915, "lon"=> -73.3931),
		array("lat"=> 44.2627, "lon"=> -73.3109),
	),
	'Bennington' => array(
		array("lat"=> 43.3152, "lon"=> -73.2562),
		array("lat"=> 43.2987, "lon"=> -72.8673),
		array("lat"=> 43.2987, "lon"=> -72.8180),
		array("lat"=> 43.2549, "lon"=> -72.8180),
		array("lat"=> 43.2604, "lon"=> -72.8454),
		array("lat"=> 43.1125, "lon"=> -72.8673),
		array("lat"=> 43.1180, "lon"=> -72.9988),
		array("lat"=> 42.9318, "lon"=> -73.0097),
		array("lat"=> 42.9263, "lon"=> -72.9221),
		array("lat"=> 42.7401, "lon"=> -72.9276),
		array("lat"=> 42.7401, "lon"=> -73.0207),
		array("lat"=> 42.7456, "lon"=> -73.2671),
		array("lat"=> 42.8003, "lon"=> -73.2890),
		array("lat"=> 42.9427, "lon"=> -73.2726),
	),
	'Caledonia' => array(
		array("lat"=> 44.7666, "lon"=> -71.9417),
		array("lat"=> 44.7173, "lon"=> -71.8376),
		array("lat"=> 44.6461, "lon"=> -71.9088),
		array("lat"=> 44.6132, "lon"=> -71.8431),
		array("lat"=> 44.5475, "lon"=> -71.9088),
		array("lat"=> 44.4982, "lon"=> -71.8541),
		array("lat"=> 44.4434, "lon"=> -71.9308),
		array("lat"=> 44.3503, "lon"=> -71.8376),
		array("lat"=> 44.3229, "lon"=> -72.0348),
		array("lat"=> 44.2736, "lon"=> -72.0677),
		array("lat"=> 44.1531, "lon"=> -72.0403),
		array("lat"=> 44.2024, "lon"=> -72.3689),
		array("lat"=> 44.4106, "lon"=> -72.2156),
		array("lat"=> 44.5037, "lon"=> -72.4237),
		array("lat"=> 44.5037, "lon"=> -72.4346),
		array("lat"=> 44.5858, "lon"=> -72.3744),
		array("lat"=> 44.5420, "lon"=> -72.2648),
		array("lat"=> 44.7008, "lon"=> -72.1444),
		array("lat"=> 44.6844, "lon"=> -72.0896),
		array("lat"=> 44.7501, "lon"=> -72.1170),
		array("lat"=> 44.7008, "lon"=> -72.0129),
	),
	'Chittenden' => array(
		array("lat"=> 44.7227, "lon"=> -73.2288),
		array("lat"=> 44.6351, "lon"=> -72.9221),
		array("lat"=> 44.5475, "lon"=> -72.8071),
		array("lat"=> 44.4599, "lon"=> -72.8399),
		array("lat"=> 44.4544, "lon"=> -72.8071),
		array("lat"=> 44.4051, "lon"=> -72.8399),
		array("lat"=> 44.3887, "lon"=> -72.8071),
		array("lat"=> 44.3667, "lon"=> -72.8618),
		array("lat"=> 44.1641, "lon"=> -72.9549),
		array("lat"=> 44.2955, "lon"=> -72.9714),
		array("lat"=> 44.2627, "lon"=> -73.2288),
		array("lat"=> 44.2627, "lon"=> -73.3109),
		array("lat"=> 44.3667, "lon"=> -73.3329),
		array("lat"=> 44.4379, "lon"=> -73.2945),
		array("lat"=> 44.5475, "lon"=> -73.3383),
		array("lat"=> 44.5639, "lon"=> -73.3602),
		array("lat"=> 44.6023, "lon"=> -73.2562),
	),
	'Essex' => array(
		array("lat"=> 45.0130, "lon"=> -71.5036),
		array("lat"=> 45.0130, "lon"=> -71.4652),
		array("lat"=> 44.9966, "lon"=> -71.5364),
		array("lat"=> 44.9035, "lon"=> -71.4981),
		array("lat"=> 44.7501, "lon"=> -71.6295),
		array("lat"=> 44.5858, "lon"=> -71.5364),
		array("lat"=> 44.5584, "lon"=> -71.5967),
		array("lat"=> 44.5037, "lon"=> -71.5802),
		array("lat"=> 44.4160, "lon"=> -71.7007),
		array("lat"=> 44.4051, "lon"=> -71.7664),
		array("lat"=> 44.3503, "lon"=> -71.8376),
		array("lat"=> 44.4434, "lon"=> -71.9308),
		array("lat"=> 44.4982, "lon"=> -71.8541),
		array("lat"=> 44.5475, "lon"=> -71.9088),
		array("lat"=> 44.6132, "lon"=> -71.8431),
		array("lat"=> 44.6461, "lon"=> -71.9088),
		array("lat"=> 44.7173, "lon"=> -71.8376),
		array("lat"=> 44.7666, "lon"=> -71.9417),
		array("lat"=> 44.7885, "lon"=> -71.9746),
		array("lat"=> 44.8761, "lon"=> -71.8760),
		array("lat"=> 44.9090, "lon"=> -71.9308),
		array("lat"=> 45.0075, "lon"=> -71.8979),
	),
	'Franklin' => array(
		array("lat"=> 45.0075, "lon"=> -72.5551),
		array("lat"=> 44.8323, "lon"=> -72.5332),
		array("lat"=> 44.7830, "lon"=> -72.5770),
		array("lat"=> 44.7939, "lon"=> -72.6756),
		array("lat"=> 44.7885, "lon"=> -72.7468),
		array("lat"=> 44.6899, "lon"=> -72.7961),
		array("lat"=> 44.7118, "lon"=> -72.8509),
		array("lat"=> 44.6351, "lon"=> -72.9221),
		array("lat"=> 44.7227, "lon"=> -73.2288),
		array("lat"=> 44.7775, "lon"=> -73.2562),
		array("lat"=> 44.8268, "lon"=> -73.2069),
		array("lat"=> 44.9035, "lon"=> -73.1905),
		array("lat"=> 44.9473, "lon"=> -73.2397),
		array("lat"=> 45.0130, "lon"=> -73.1905),
	),
	'Grand Isle' => array(
		array("lat"=> 45.0130, "lon"=> -73.1905),
		array("lat"=> 44.9473, "lon"=> -73.2397),
		array("lat"=> 44.9035, "lon"=> -73.1905),
		array("lat"=> 44.8268, "lon"=> -73.2069),
		array("lat"=> 44.7775, "lon"=> -73.2562),
		array("lat"=> 44.7227, "lon"=> -73.2288),
		array("lat"=> 44.6023, "lon"=> -73.2562),
		array("lat"=> 44.5639, "lon"=> -73.3602),
		array("lat"=> 44.6187, "lon"=> -73.3876),
		array("lat"=> 44.7885, "lon"=> -73.3329),
		array("lat"=> 44.8487, "lon"=> -73.3821),
		array("lat"=> 44.9199, "lon"=> -73.3383),
		array("lat"=> 45.0130, "lon"=> -73.3438),
	),
	'Lamoille' => array(
		array("lat"=> 44.7939, "lon"=> -72.6756),
		array("lat"=> 44.7830, "lon"=> -72.5770),
		array("lat"=> 44.7227, "lon"=> -72.4182),
		array("lat"=> 44.6351, "lon"=> -72.4839),
		array("lat"=> 44.5858, "lon"=> -72.3744),
		array("lat"=> 44.5037, "lon"=> -72.4346),
		array("lat"=> 44.4270, "lon"=> -72.4894),
		array("lat"=> 44.4818, "lon"=> -72.5989),
		array("lat"=> 44.3996, "lon"=> -72.6537),
		array("lat"=> 44.4544, "lon"=> -72.8071),
		array("lat"=> 44.4599, "lon"=> -72.8399),
		array("lat"=> 44.5475, "lon"=> -72.8071),
		array("lat"=> 44.6351, "lon"=> -72.9221),
		array("lat"=> 44.7118, "lon"=> -72.8509),
		array("lat"=> 44.6899, "lon"=> -72.7961),
		array("lat"=> 44.7885, "lon"=> -72.7468),
	),
	'Orange' => array(
		array("lat"=> 44.1531, "lon"=> -72.4346),
		array("lat"=> 44.2189, "lon"=> -72.4182),
		array("lat"=> 44.2024, "lon"=> -72.3689),
		array("lat"=> 44.1531, "lon"=> -72.0403),
		array("lat"=> 44.0765, "lon"=> -72.0293),
		array("lat"=> 43.9943, "lon"=> -72.1170),
		array("lat"=> 43.9669, "lon"=> -72.0896),
		array("lat"=> 43.8629, "lon"=> -72.1827),
		array("lat"=> 43.7698, "lon"=> -72.2046),
		array("lat"=> 43.9286, "lon"=> -72.7852),
		array("lat"=> 43.9615, "lon"=> -72.7906),
		array("lat"=> 44.0272, "lon"=> -72.7413),
		array("lat"=> 44.0107, "lon"=> -72.6811),
		array("lat"=> 44.1586, "lon"=> -72.5880),
		array("lat"=> 44.1312, "lon"=> -72.4456),
	),
	'Orleans' => array(
		array("lat"=> 45.0075, "lon"=> -71.8979),
		array("lat"=> 44.9090, "lon"=> -71.9308),
		array("lat"=> 44.8761, "lon"=> -71.8760),
		array("lat"=> 44.7885, "lon"=> -71.9746),
		array("lat"=> 44.7666, "lon"=> -71.9417),
		array("lat"=> 44.7008, "lon"=> -72.0129),
		array("lat"=> 44.7501, "lon"=> -72.1170),
		array("lat"=> 44.6844, "lon"=> -72.0896),
		array("lat"=> 44.7008, "lon"=> -72.1444),
		array("lat"=> 44.5420, "lon"=> -72.2648),
		array("lat"=> 44.5858, "lon"=> -72.3744),
		array("lat"=> 44.6351, "lon"=> -72.4839),
		array("lat"=> 44.7227, "lon"=> -72.4182),
		array("lat"=> 44.7830, "lon"=> -72.5770),
		array("lat"=> 44.8323, "lon"=> -72.5332),
		array("lat"=> 45.0075, "lon"=> -72.5551),
	),
	'Rutland' => array(
		array("lat"=> 43.7533, "lon"=> -73.3657),
		array("lat"=> 43.7643, "lon"=> -73.2069),
		array("lat"=> 43.8355, "lon"=> -73.2178),
		array("lat"=> 43.8464, "lon"=> -73.0316),
		array("lat"=> 43.8026, "lon"=> -73.0152),
		array("lat"=> 43.8245, "lon"=> -72.9604),
		array("lat"=> 43.8574, "lon"=> -72.8728),
		array("lat"=> 43.8300, "lon"=> -72.7961),
		array("lat"=> 43.7150, "lon"=> -72.8180),
		array("lat"=> 43.6821, "lon"=> -72.7030),
		array("lat"=> 43.5890, "lon"=> -72.7742),
		array("lat"=> 43.4959, "lon"=> -72.7906),
		array("lat"=> 43.4631, "lon"=> -72.7249),
		array("lat"=> 43.3535, "lon"=> -72.7578),
		array("lat"=> 43.3699, "lon"=> -72.8509),
		array("lat"=> 43.2987, "lon"=> -72.8673),
		array("lat"=> 43.3152, "lon"=> -73.2562),
		array("lat"=> 43.5562, "lon"=> -73.2507),
		array("lat"=> 43.5781, "lon"=> -73.2945),
		array("lat"=> 43.6274, "lon"=> -73.3055),
		array("lat"=> 43.6219, "lon"=> -73.3712),
		array("lat"=> 43.5671, "lon"=> -73.3931),
		array("lat"=> 43.5890, "lon"=> -73.4314),
	),
	'Washington' => array(
		array("lat"=> 44.5037, "lon"=> -72.4237),
		array("lat"=> 44.4106, "lon"=> -72.2156),
		array("lat"=> 44.2024, "lon"=> -72.3689),
		array("lat"=> 44.2189, "lon"=> -72.4182),
		array("lat"=> 44.1531, "lon"=> -72.4346),
		array("lat"=> 44.1312, "lon"=> -72.4456),
		array("lat"=> 44.1586, "lon"=> -72.5880),
		array("lat"=> 44.0107, "lon"=> -72.6811),
		array("lat"=> 44.0272, "lon"=> -72.7413),
		array("lat"=> 44.0710, "lon"=> -72.9166),
		array("lat"=> 44.1641, "lon"=> -72.9549),
		array("lat"=> 44.3667, "lon"=> -72.8618),
		array("lat"=> 44.3887, "lon"=> -72.8071),
		array("lat"=> 44.4051, "lon"=> -72.8399),
		array("lat"=> 44.4544, "lon"=> -72.8071),
		array("lat"=> 44.3996, "lon"=> -72.6537),
		array("lat"=> 44.4818, "lon"=> -72.5989),
		array("lat"=> 44.4270, "lon"=> -72.4894),
		array("lat"=> 44.5037, "lon"=> -72.4346),
	),
	'Windham' => array(
		array("lat"=> 43.2549, "lon"=> -72.8180),
		array("lat"=> 43.2221, "lon"=> -72.6866),
		array("lat"=> 43.2330, "lon"=> -72.4346),
		array("lat"=> 43.1618, "lon"=> -72.4511),
		array("lat"=> 43.0851, "lon"=> -72.4346),
		array("lat"=> 43.0523, "lon"=> -72.4675),
		array("lat"=> 43.0085, "lon"=> -72.4456),
		array("lat"=> 42.9537, "lon"=> -72.5332),
		array("lat"=> 42.8551, "lon"=> -72.5551),
		array("lat"=> 42.7675, "lon"=> -72.5168),
		array("lat"=> 42.7291, "lon"=> -72.4565),
		array("lat"=> 42.7401, "lon"=> -72.9276),
		array("lat"=> 42.9263, "lon"=> -72.9221),
		array("lat"=> 42.9318, "lon"=> -73.0097),
		array("lat"=> 43.1180, "lon"=> -72.9988),
		array("lat"=> 43.1125, "lon"=> -72.8673),
		array("lat"=> 43.2604, "lon"=> -72.8454),
	),
	'Windsor' => array(
		array("lat"=> 43.9615, "lon"=> -72.7906),
		array("lat"=> 43.9286, "lon"=> -72.7852),
		array("lat"=> 43.7698, "lon"=> -72.2046),
		array("lat"=> 43.7040, "lon"=> -72.3032),
		array("lat"=> 43.6000, "lon"=> -72.3306),
		array("lat"=> 43.5726, "lon"=> -72.3799),
		array("lat"=> 43.5233, "lon"=> -72.3963),
		array("lat"=> 43.3754, "lon"=> -72.4182),
		array("lat"=> 43.3152, "lon"=> -72.3963),
		array("lat"=> 43.2330, "lon"=> -72.4346),
		array("lat"=> 43.2221, "lon"=> -72.6866),
		array("lat"=> 43.2549, "lon"=> -72.8180),
		array("lat"=> 43.2987, "lon"=> -72.8180),
		array("lat"=> 43.2987, "lon"=> -72.8673),
		array("lat"=> 43.3699, "lon"=> -72.8509),
		array("lat"=> 43.3535, "lon"=> -72.7578),
		array("lat"=> 43.4631, "lon"=> -72.7249),
		array("lat"=> 43.4959, "lon"=> -72.7906),
		array("lat"=> 43.5890, "lon"=> -72.7742),
		array("lat"=> 43.6821, "lon"=> -72.7030),
		array("lat"=> 43.7150, "lon"=> -72.8180),
		array("lat"=> 43.8300, "lon"=> -72.7961),
		array("lat"=> 43.8574, "lon"=> -72.8728),
		array("lat"=> 43.8245, "lon"=> -72.9604),
		array("lat"=> 43.8683, "lon"=> -72.9714),
		array("lat"=> 43.9012, "lon"=> -72.8783),
		array("lat"=> 43.8629, "lon"=> -72.8673),
	)
);
$countyDocuments = array();
$id = 1;
foreach ($counties as $county => $shape) {
	$countyDocuments[] = new \Elastica\Document($id, array(
		'id' => $id,
		'county' => $county,
		'shape' => $shape
	));
	$id++;
}
// Add venue to type
$elasticaType->addDocuments($countyDocuments);

// Refresh Index
$elasticaType->getIndex()->refresh();
